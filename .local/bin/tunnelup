#!/bin/sh
PIDFILE=$XDG_RUNTIME_DIR/tunnel.pid

if [ -e $PIDFILE ]; then
	if ps -p $(< $PIDFILE) >/dev/null; then
		zenity --error --text="Tunnel already running"

		exit 1
	else
		rm $PIDFILE
	fi
fi

SSH_ASKPASS=/usr/local/bin/ssh-askpass-zenity setsid ssh -ND 8000 dumont &
echo $! > $XDG_RUNTIME_DIR/tunnel.pid
